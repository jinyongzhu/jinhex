{"meta":{"title":"技术博客 - Hexo","subtitle":"Hexo Blog","description":"个人技术博客，记录在日常工作中的技术问题的点点滴滴。","author":"Jin yongzhu","url":"https://jinyongzhu.github.io","root":"/"},"pages":[{"title":"关于","date":"2019-11-19T10:36:14.000Z","updated":"2019-11-21T06:47:10.424Z","comments":true,"path":"about/index.html","permalink":"https://jinyongzhu.github.io/about/index.html","excerpt":"","text":""},{"title":"书单","date":"2019-11-19T09:55:31.108Z","updated":"2019-11-19T09:55:31.108Z","comments":false,"path":"books/index.html","permalink":"https://jinyongzhu.github.io/books/index.html","excerpt":"","text":""},{"title":"分类","date":"2019-11-22T01:50:29.000Z","updated":"2019-11-22T01:53:31.175Z","comments":true,"path":"categories/index.html","permalink":"https://jinyongzhu.github.io/categories/index.html","excerpt":"","text":""},{"title":"Repositories","date":"2019-11-19T09:55:31.109Z","updated":"2019-11-19T09:55:31.109Z","comments":false,"path":"repository/index.html","permalink":"https://jinyongzhu.github.io/repository/index.html","excerpt":"","text":""},{"title":"友情链接","date":"2019-11-19T09:55:31.109Z","updated":"2019-11-19T09:55:31.109Z","comments":true,"path":"links/index.html","permalink":"https://jinyongzhu.github.io/links/index.html","excerpt":"","text":""},{"title":"timeline","date":"2019-11-20T07:35:21.000Z","updated":"2019-11-20T07:35:21.564Z","comments":true,"path":"timeline/index.html","permalink":"https://jinyongzhu.github.io/timeline/index.html","excerpt":"","text":""},{"title":"标签","date":"2019-11-22T01:52:29.000Z","updated":"2019-11-22T01:58:50.205Z","comments":true,"path":"tags/index.html","permalink":"https://jinyongzhu.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Python备份MySQL数据库脚本","slug":"Python备份MySQL数据库脚本","date":"2019-11-20T08:18:38.000Z","updated":"2019-11-21T06:56:28.446Z","comments":true,"path":"2019/1120/Python备份MySQL数据库脚本/","link":"","permalink":"https://jinyongzhu.github.io/2019/1120/Python%E5%A4%87%E4%BB%BDMySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%84%9A%E6%9C%AC/","excerpt":"","text":"#!/usr/bin/env python3 import os import time import datetime 定义服务器，用户名、密码、数据库名称（多个库分行放置）和备份的路径 DB_USER = ‘root’ DB_PASSWD = ‘root7895123’ DB_NAME = ‘/root/dbnames.txt’ MYSQLDUMP = ‘/usr/local/mysql/bin/mysqldump’ BACKUP_PATH = ‘/data/backup/mysql/’ DATETIME = time.strftime(’%Y%m%d-%H%M%S’) TODAYBACKUPPATH = BACKUP_PATH + DATETIME print(“createing backup folder!”) 创建备份文件夹 if not os.path.exists(TODAYBACKUPPATH): os.makedirs(TODAYBACKUPPATH) print(“checking for databases names file”) 定义执行备份脚本，读取文件中的数据库名称，注意按行读写，不校验是否存在该库 def run_backup(): in_file = open(DB_NAME,“r”) for dbname in in_file.readlines(): dbname = dbname.strip() print(“now starting backup database %s” %dbname) dumpcmd = MYSQLDUMP+&quot; -u&quot; +DB_USER + &quot; -p&quot;+DB_PASSWD+&quot; &quot; +dbname+&quot; &gt; “+TODAYBACKUPPATH +”/&quot;+dbname+&quot;.sql&quot; os.system(dumpcmd) in_file.close() 执行压缩的函数 def run_tar(): compress_file = TODAYBACKUPPATH + “.tar.gz” compress_cmd = “tar -czvf &quot; +compress_file+” &quot;+DATETIME os.chdir(BACKUP_PATH) os.system(“pwd”) os.system(compress_cmd) print(“compress complete!”) # 删除备份文件夹 remove_cmd = &quot;rm -rf &quot;+TODAYBACKUPPATH os.system(remove_cmd) 备份数据库文件存在就执行备份和压缩,否则退出 if os.path.exists(DB_NAME): file1 = open(DB_NAME) print(&quot;starting backup of all db listed in file &quot;+DB_NAME) run_backup() run_tar() print(“backup success!”) else: print(“database file not found…”) exit() Python脚本备份定时任务 30 9 * * * /usr/local/bin/python3 /usr/local/sbin/python_backup.py &gt; /dev/null 2&gt;&amp;1","categories":[{"name":"Python","slug":"Python","permalink":"https://jinyongzhu.github.io/categories/Python/"}],"tags":[{"name":"Python","slug":"Python","permalink":"https://jinyongzhu.github.io/tags/Python/"},{"name":"MySQL","slug":"MySQL","permalink":"https://jinyongzhu.github.io/tags/MySQL/"}]},{"title":"nginx配置Google海外代理","slug":"nginx配置Google海外代理","date":"2019-11-20T06:58:02.000Z","updated":"2019-11-21T06:56:11.318Z","comments":true,"path":"2019/1120/nginx配置Google海外代理/","link":"","permalink":"https://jinyongzhu.github.io/2019/1120/nginx%E9%85%8D%E7%BD%AEGoogle%E6%B5%B7%E5%A4%96%E4%BB%A3%E7%90%86/","excerpt":"","text":"proxy_cache_path /run/shm levels=1:2 keys_zone=one:100m max_size=1g; proxy_cache_key hosthosthostrequest_uri; upstream google { server 216.58.221.142 max_fails=3 fail_timeout=10s; //IP自己添加 } server { listen 80; server_name g.ttlsa.com; location / { proxy_pass http://google; proxy_cache one; proxy_cache_valid 200 302 2h; proxy_cache_valid 404 1h; proxy_buffering off; proxy_cookie_domain google.com g.ttlsa.com; proxy_redirect https://www.google.com/ /; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header Accept-Encoding &quot;&quot;; proxy_set_header User-Agent $http_user_agent; sub_filter www.google.com g.ttlsa.com; sub_filter_once off; } }","categories":[{"name":"Linux","slug":"Linux","permalink":"https://jinyongzhu.github.io/categories/Linux/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://jinyongzhu.github.io/tags/Nginx/"},{"name":"Linux","slug":"Linux","permalink":"https://jinyongzhu.github.io/tags/Linux/"}]}]}